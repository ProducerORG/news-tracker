<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/app.js" defer></script>
</head>
<body class="h-screen flex">

    <!-- Sidebar -->
    <aside class="w-80 bg-[var(--light-gray)] p-6 flex flex-col justify-between">
        <div>
            <img src="https://glueckswirtschaft.de/media/site/813e60f13a-1743167695/glueckswirtschaft-logo.svg" alt="Glückswirtschaft Logo" style="width: 100%; max-width: 160px; margin-bottom: 1rem;">
            <h1 class="text-2xl font-serif text-[var(--gold)] mb-4">News-Tracker</h1>
            <h2 class="font-bold mb-2">Was macht der Tracker?</h2>
            <p class="text-sm leading-relaxed text-[var(--text-dark)] mb-6">
                Er sammelt und dokumentiert Nachrichten und Berichte von einschlägigen Presseseiten. 
                Die Tabellenansicht zeigt Ihnen aktuellste Einträge in Echtzeit. Sortieren Sie durch Klick auf die Spalte. Unten findet sich eine Liste der aktuell angezapften Quellen. Beantragen Sie die Einbindung einer neuen Quelle über das Formular.
            </p>

            <h2 class="font-bold mb-2">Quelle beantragen</h2>
            <form id="request-form" class="flex flex-col gap-3">
                <input type="url" name="url" placeholder="Quellen-URL" required
                    class="border border-gray-300 rounded p-2 w-full bg-white text-sm">
                <textarea name="comment" placeholder="Kommentar"
                    class="border border-gray-300 rounded p-2 w-full bg-white text-sm"></textarea>
                <button type="submit"
                    class="bg-[var(--gold)] hover:bg-yellow-700 text-white rounded p-2 text-sm">
                    Absenden
                </button>
            </form>
        </div>
        <button id="toggleTrashButton" onclick="toggleTrash()" class="text-sm text-gray-600 hover:text-black mt-10">
            Papierkorb ansehen
        </button>
        <p class="text-xs text-gray-500">&copy; 2025 Glückswirtschaft</p>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8 overflow-auto">
        <h1 class="text-3xl font-bold mb-6 text-[var(--gold)]">Beiträge</h1>
        <div class="overflow-x-auto">
            <table class="w-full border-collapse shadow-md">
                <thead>
                    <tr class="bg-[var(--light-gray)]">
                        <th class="p-2 border cursor-pointer" onclick="sortPosts('date')">Datum</th>
                        <th class="p-2 border cursor-pointer" onclick="sortPosts('source_id')">Quelle</th>
                        <th class="p-2 border cursor-pointer" onclick="sortPosts('title')">Titel</th>
                        <th class="p-2 border">Link</th>
                        <th class="p-2 border">Löschen</th>
                    </tr>
                </thead>
                <tbody id="posts-body" class="bg-white"></tbody>
            </table>
        </div>
    </main>

    <script>
        document.getElementById('request-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            await fetch('/public/api.php?action=source-request', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    url: formData.get('url'),
                    comment: formData.get('comment')
                })
            });
            alert('Anfrage gesendet.');
            e.target.reset();
        });
    </script>
</body>
</html>