<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/js/app.js" defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        h3, h4 {
            font-family: 'Playfair Display', serif;
        }
    </style>
</head>
<body class="h-screen flex">

    <!-- Sidebar -->
    <aside class="w-80 bg-[var(--light-gray)] p-6 flex flex-col justify-start font-sans">
        <img src="https://glueckswirtschaft.de/media/site/813e60f13a-1743167695/glueckswirtschaft-logo.svg"
            alt="Glückswirtschaft Logo"
            class="w-full max-w-xs mb-6">

        <h3 class="font-serif text-[var(--gold)] text-lg mt-4">Was macht der Tracker?</h3>
        <p class="text-sm mt-2 leading-relaxed">
            Er sammelt und dokumentiert Nachrichten und Berichte von einschlägigen Presseseiten. 
            Die Tabellenansicht zeigt Ihnen aktuellste Einträge in Echtzeit. Sortieren Sie durch Klick auf die Spalte. 
            Unten findet sich eine Liste der aktuell angezapften Quellen. Beantragen Sie die Einbindung einer neuen Quelle über das Formular.
        </p>

        <h3 class="font-serif text-[var(--gold)] text-lg mt-8">Quelle beantragen</h3>
        <form id="request-form" class="mt-4 flex flex-col gap-3">
            <input type="url" name="url" placeholder="Quellen-URL" required
                class="p-2 border border-gray-300 rounded bg-white text-sm">
            <textarea name="comment" placeholder="Kommentar"
                class="p-2 border border-gray-300 rounded bg-white text-sm"></textarea>
            <button type="submit"
                class="bg-[var(--gold)] hover:bg-yellow-700 text-white rounded p-2 text-sm transition">
                Absenden
            </button>
        </form>
        <br><br><br>
        <button id="toggleTrashButton"
            onclick="toggleTrash()"
            class="mt-6 text-sm px-4 py-2 rounded bg-[var(--gold)] text-white hover:bg-yellow-700 transition">
            Papierkorb ansehen
        </button>
    </aside>
            

    <!-- Main Content -->
    <main class="flex-1 p-8 overflow-auto">
        <h1 id="page-title" class="text-3xl font-bold mb-6 text-[var(--gold)]">Beiträge</h1>
        <div class="overflow-x-auto">
            <table class="w-full border-collapse shadow-md">
                <thead>
                    <tr class="bg-[var(--light-gray)]">
                        <th class="p-2 border cursor-pointer" onclick="sortPosts('date')">Datum</th>
                        <th class="p-2 border cursor-pointer" onclick="sortPosts('source_id')">Quelle</th>
                        <th class="p-2 border cursor-pointer" onclick="sortPosts('title')">Titel</th>
                        <th class="p-2 border">Link</th>
                        <th class="p-2 border">Löschen</th>
                    </tr>
                </thead>
                <tbody id="posts-body" class="bg-white"></tbody>
            </table>
        </div>
    </main>

    <script>
        document.getElementById('request-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            await fetch('/public/api.php?action=source-request', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    url: formData.get('url'),
                    comment: formData.get('comment')
                })
            });
            alert('Anfrage gesendet.');
            e.target.reset();
        });
    </script>
</body>
</html>